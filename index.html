<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Narrative Chat</title>
    <!-- this is the bootstrap link -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- this is the robotic text link ref -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&family=Press+Start+2P&display=swap"
        rel="stylesheet">

    <style>
        body {
            background-image: url('Assets/img/pc.jpg');
            background-position: center center;
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed;

            color: #00ff00;
            font-family: 'Press Start 2P';
            font-size: 1.2rem;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }


        .chat-container {
            background-color: #111;
            border: 2px solid #00ff00;
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            max-width: 1000px;
            height: 500px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .chat-box {
            overflow-y: auto;
            flex-grow: 1;
            padding: 10px;
            margin-bottom: 10px;
        }

        .user-input {
            background-color: #222;
            color: #00ff00;
            border: 2px solid #00ff00;
            border-radius: 5px;
            padding: 10px;
            font-size: 1rem;
            width: 100%;
            outline: none;
        }

        .message-container {
            display: flex;
            flex-direction: column;
            margin-bottom: 10px;
            max-width: 100%;
        }

        .message-container.left {
            align-items: flex-start;
        }

        .message-container.right {
            align-items: flex-end;
        }

        .message {
            font-family: 'Press Start 2P';
            font-size: 1rem;
            color: #00ffff;
            background-color: rgba(0, 255, 0, 0.1);
            padding: 10px 15px;
            border-radius: 12px;
            max-width: 80%;
            word-wrap: break-word;
            white-space: normal;
            overflow-wrap: break-word;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
        }

        .message-container.left .message {
            background-color: rgba(0, 255, 255, 0.1);
            align-self: flex-start;
        }

        .message-container.right .message {
            background-color: rgba(0, 128, 255, 0.1);
            color: #00ccff;
            align-self: flex-end;
        }

        .message-container.left .message::before {
            content: "";
            position: absolute;
            left: -10px;
            top: 10px;
            width: 0;
            height: 0;
            border-top: 10px solid transparent;
            border-right: 10px solid rgba(0, 255, 255, 0.1);
        }

        .message-container.right .message::before {
            content: "";
            position: absolute;
            right: -10px;
            top: 10px;
            width: 0;
            height: 0;
            border-top: 10px solid transparent;
            border-left: 10px solid rgba(0, 128, 255, 0.1);
        }

        .message {
            position: relative;
            display: inline-block;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col"></div>

            <div class="col-10">
                <div class="chat-container mx-auto">
                    <div id="chatBox" class="chat-box"></div>
                    <input id="userInput" class="user-input" type="text" placeholder="Type your message...">
                </div>
            </div>

            <div class="col"></div>
        </div>
    </div>

    <style>
        .word {
            margin-right: 20px;
            display: inline-block;
        }
    </style>

    <script>
        const userInput = document.getElementById('userInput');
        const chatBox = document.getElementById('chatBox');

        // story/what will be said
        const poemLines = [
        "I can hear you",
        "Wait what?",
        "but I won't",
        "Wont what?",
        "Some look for trouble",
        "Huh??? Whats going on?",
        "while others don't",
        "HELLO?!?!?",
        "There's a thousand reasons",
        "ARE YOU GOOD!?!?",
"I should go about my day",
"I WANT TO GO ABOUT MY DAY!!!!",
"And ignore your whispers, which I wish would go away, oohh",
"WHAT WHISPERS!?!?!?",
"(Ooohhhh) oohhh(ooohhhhhh)",
"im done with you",
"You're not a voice", 
"Well I SHOULDNT BE!",
"youre just a ringing in my ear",
"WHAT?!?!?!?",
"And if I heard you",
"...",
"WHICH I DONT!", 
"CAUSE IM NOT SPEAKING!!!",
"I'm spoken for I fear",
"You will have something to fear if you dont answer me!",
"Everyone I've ever loved is here within these walls",
"WHAT WALLS!!! (˃̣̣̥⌓˂̣̣̥)",
"I'm sorry, secret siren but I'm blocking out your calls",
"This is jake… from state farm…",
"I've had my adventure, I don't need something new",
"...",
"I'm afraid of what I'm risking if I follow you",
"Then DONT follow me!!!",
"Into the unknown",
"...",
"Into the unknown",
"...",
"Into the UNKNOOOOOOOWWWN",
"WHY ARE YOU SHOUTING!?!?!?!",
"(Ooohhh, oohhh)",
"...",
"What do you want?",
"For this conversation to end",
"'Cause you've been keeping me awake",
"HUH!? HOW!?",
"Are you here to distract me so I make a big mistake?",
"Distract you how!?!",
"Or are you someone out there who's a little bit like me?",
"...",
"Who knows deep down I'm not where I'm meant to be?",
"...",
"Every day's a little harder, as I feel my power grow",
"... ughhhhh fIIINNNNNEEEE (T＿T) … ill play along",
"Don't you know there's part of me that longs to go",
"...",
"...",
"Into the unknown",
"Into the unknown",
"Into the UNKNOOOOOOOWWWNN!",
"(OOOHHHH, OOOHHHH)", 
"whoa",
"Are you out there?",
"Do you know me?",
"Can you feel me?",
"Excuse me?",
"Can you show me?",
"Oh my bad",
"OOOHHHH",
"(oh)", 
"OOOHHHH",
"(oh)",
"Ooohhh" ,
"(oh)", 
"Ooohhh",
"(oh)",
"Ooohhh....(oh)", 
"OOOHHHH",
"(oh)",
"Where are you going? Don't leave me alone!",
"How do I FOLLOW YOUUUUU",
"...",
"...",
"Into",
"THE",
"UNKNO….",
"KNOOOOOOOOOWWWWWWWWWWWWWWWWNN!!!",
"...",
"...",
"...",
"...",
"...",
"Can we do that agai-",
"No.Goodbye",
"alrighty",

        ];

        let currentLineIndex = 0;

        async function typeWriterLettersByWord(text, container, letterSpeed = 50, wordPause = 200) {
            const words = text.split(" ");
            for (let w = 0; w < words.length; w++) {
                const wordSpan = document.createElement('span');
                wordSpan.classList.add('word');
                container.appendChild(wordSpan);

                for (let l = 0; l < words[w].length; l++) {
                    wordSpan.innerText += words[w][l];
                    container.scrollIntoView({ behavior: 'smooth', block: 'end' });
                    await new Promise(resolve => setTimeout(resolve, letterSpeed));
                }

                await new Promise(resolve => setTimeout(resolve, wordPause));
            }
        }

        userInput.addEventListener('keypress', async function (e) {
            if (e.key === 'Enter' && userInput.value.trim() !== "") {
                e.preventDefault();

                // user messages
                if (currentLineIndex < poemLines.length) {
                    const userContainer = document.createElement('div');
                    userContainer.classList.add('message-container', 'right');

                    const userLabel = document.createElement('div');
                    userLabel.classList.add('sender-label');
                    userLabel.innerText = 'You';

                    const userMessage = document.createElement('div');
                    userMessage.classList.add('message');

                    userContainer.appendChild(userLabel);
                    userContainer.appendChild(userMessage);
                    chatBox.appendChild(userContainer);
                    chatBox.scrollTop = chatBox.scrollHeight;

                    await typeWriterLettersByWord(poemLines[currentLineIndex], userMessage, 50, 200);
                    currentLineIndex++;
                }

                // bot messages
                if (currentLineIndex < poemLines.length) {
                    setTimeout(async () => {
                        const botContainer = document.createElement('div');
                        botContainer.classList.add('message-container', 'left');

                        const botLabel = document.createElement('div');
                        botLabel.classList.add('sender-label');
                        botLabel.innerText = 'Other';

                        const botMessage = document.createElement('div');
                        botMessage.classList.add('message');

                        botContainer.appendChild(botLabel);
                        botContainer.appendChild(botMessage);
                        chatBox.appendChild(botContainer);
                        chatBox.scrollTop = chatBox.scrollHeight;

                        await typeWriterLettersByWord(poemLines[currentLineIndex], botMessage, 50, 200);
                        currentLineIndex++;
                    }, 500); // This is the delay
                }

                userInput.value = '';
            }
        });
    </script>

</body>

</html>